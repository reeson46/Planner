{% load static %}
<link rel="stylesheet" href="{% static 'dashboard/sidebar/css/sidebar.css' %}">


<ul class="sidebar-nav">
  <div class="bg-dark mt-1 mb-3" id="account-wrapper">
    {% if user.is_authenticated %}
    <div class="d-flex justify-content-between" style="height: 100%;">
      <span class="d-flex text-white user-name-wrapper">
        <div>Hello,&nbsp;</div>
        <div class="user-name">{{user.username }}</div>
      </span>
      <div class="dropdown" style="margin: auto 10px;">
        <svg xmlns="http://www.w3.org/2000/svg" data-display="static" type="button" id="accountDropdown"
          data-bs-toggle="dropdown" aria-expanded="false" width="22" height="22" fill="currentColor"
          class="bi bi-caret-right-square dropdown-caret" viewBox="0 0 16 16">
          <path
            d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z" />
          <path
            d="M5.795 12.456A.5.5 0 0 1 5.5 12V4a.5.5 0 0 1 .832-.374l4.5 4a.5.5 0 0 1 0 .748l-4.5 4a.5.5 0 0 1-.537.082z" />
        </svg>
        <ul class="dropdown-menu dropdown-menu-user bg-dark" aria-labelledby="accountDropdown">
          <li class="account-dropdown-item"><a id="account-btn" href="#">Account</a></li>
          <li class="account-dropdown-item"><a id="logout-btn" href="{% url 'account:logout' %}">Logout</a></li>
        </ul>
      </div>
    </div>
    {% else %}
    <div class="d-flex justify-content-between" style="height: 100%;">
      <span class="d-flex text-white user-name-wrapper">
        <div>Hello,&nbsp;</div>
        <div class="user-name">Guest</div>
      </span>
      <div class="dropdown" style="margin: auto 10px;">
        <svg xmlns="http://www.w3.org/2000/svg" data-display="static" type="button" id="accountDropdown"
          data-bs-toggle="dropdown" aria-expanded="false" width="22" height="22" fill="currentColor"
          class="bi bi-caret-right-square dropdown-caret" viewBox="0 0 16 16">
          <path
            d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z" />
          <path
            d="M5.795 12.456A.5.5 0 0 1 5.5 12V4a.5.5 0 0 1 .832-.374l4.5 4a.5.5 0 0 1 0 .748l-4.5 4a.5.5 0 0 1-.537.082z" />
        </svg>
        <ul class="dropdown-menu dropdown-menu-guest bg-dark" aria-labelledby="accountDropdown">
          <li class="account-dropdown-item"><a id="account-btn" href="{% url 'account:login' %}">Login</a></li>
          <li class="account-dropdown-item"><a id="logout-btn" href="{% url 'account:register' %}">Sign Up</a></li>
        </ul>
      </div>
    </div>
    {% endif %}
  </div>
  <div class="bg-dark mb-3" id="sidebar-new-task-wrapper">
    <div class="text-white fs-4 text-center mt-2 new-task-text">New Task</div>
    <div class="container" id="sidebar-new-task">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="orange"
        class="bi bi-plus-square 
        {% if not user.is_authenticated and total_tasks|length >= 10 %}
        sidebar-add-task-guest
        {% else %}
        newtask-icon
        {% endif%}
        sidebar-add-newtask" viewBox="0 0 16 16" data-bs-toggle="tooltip" data-bs-placement="right" title="">
        <path
          d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z" />
        <path
          d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z" />
      </svg>
    </div>
  </div>

  <div class="bg-dark mb-3" id="board-wrapper">
    <div class="container mb-2 mt-2">
      <div class="row">
        <span class="d-flex justify-content-between">
          <div class="fs-4 text-white">
            Boards
          </div>
          <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="orange" class="bi bi-plus-square
            {% if user.is_authenticated %}
            rename-add-icon sidebar-add-icon
            {% else %} 
            sidebar-add-board-guest
            {% endif %}" data-sender="board" data-action="add"
            data-placeholder="Enter Board name" data-value="" data-id="" viewBox="0 0 16 16" data-bs-toggle="tooltip" data-bs-placement="right" title="">
            <path
              d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z" />
            <path
              d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z" />
          </svg>
        </span>
      </div>
    </div>
    <div class="container" id="sidebar-boards">
      {% for board in boards %}
      <li class="row hovered-nav-item board-item" value="{{ board.id }}">
        <span class="d-flex justify-content-between">
          <div class="fs-5 text-white board-name" value="{{ board.id }}">
            {{ board.name }}
          </div>
          <div class="dropdown sidebar-dropdown d-flex">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" class="bi bi-three-dots-vertical dot-icon"
              type="button" id="dropdownMenuButton{{ board.id }}" data-bs-toggle="dropdown" aria-expanded="false"
              viewBox="0 0 16 16">
              <path
                d="M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z" />
            </svg>

            <ul class="dropdown-menu dropdown-menu-sidebar dropdown-menu-dark"
              aria-labelledby="dropdownMenuButton{{ board.id }}">
              <li class="d-flex">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                  class="bi bi-pen-fill rename-add-icon rename-add-icon-sidebar" data-sender="board"
                  data-action="rename" data-placeholder="" data-value="{{ board.name }}" data-id="{{ board.id }}"
                  viewBox="0 0 16 16">
                  <path
                    d="m13.498.795.149-.149a1.207 1.207 0 1 1 1.707 1.708l-.149.148a1.5 1.5 0 0 1-.059 2.059L4.854 14.854a.5.5 0 0 1-.233.131l-4 1a.5.5 0 0 1-.606-.606l1-4a.5.5 0 0 1 .131-.232l9.642-9.642a.5.5 0 0 0-.642.056L6.854 4.854a.5.5 0 1 1-.708-.708L9.44.854A1.5 1.5 0 0 1 11.5.796a1.5 1.5 0 0 1 1.998-.001z" />
                </svg>
              </li>

              {% if boards|length > 1 %}
              <li class="d-flex mt-1">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="orange"
                  class="bi bi-x-lg delete-icon" data-sender="board" data-action="delete" data-name="{{ board.name }}"
                  data-id="{{ board.id }}" viewBox="0 0 16 16">
                  <path
                    d="M1.293 1.293a1 1 0 0 1 1.414 0L8 6.586l5.293-5.293a1 1 0 1 1 1.414 1.414L9.414 8l5.293 5.293a1 1 0 0 1-1.414 1.414L8 9.414l-5.293 5.293a1 1 0 0 1-1.414-1.414L6.586 8 1.293 2.707a1 1 0 0 1 0-1.414z" />
                </svg>
              </li>
              {% endif %}
            </ul>
          </div>
        </span>
      </li>
      {% endfor %}
    </div>
  </div>

  <div class="bg-dark" id="category-wrapper">
    <div class="container mt-2 mb-2">
      <div class="row">
        <span class="d-flex justify-content-between">
          <div class="fs-4 text-white">
            Categories
          </div>
          <div class="category-tooltip-div" data-bs-toggle="tooltip" data-bs-placement="right" title="">
          <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="orange" id="sidebar-add-category"
            class="bi bi-plus-square
            {% if not user.is_authenticated and categories|length >= 3 %}
            add-category-guest 
            {% else %}
            rename-add-icon category-add-icon
            {% endif%}
            global-add-category-icon" data-sender="category" data-action="add"
            data-source="sidebar" data-placeholder="Enter Category name" data-value="" data-id="" data-source="sidebar"
            viewBox="0 0 16 16" >
            <path
              d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z" />
            <path
              d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z" />
          </svg>
          </div>
        </span>
      </div>
    
    </div>
    <div class="container" id="sidebar-categories">
      <li class="row hovered-nav-item active-category" value="-1">
        <span class="category-link category-item fs-5 d-flex " id="sidebar-all-tasks" value="-1">
          <div class="all-tasks-text">All</div>
          {% if total_tasks %}
          <div class="total-number">
            <div class="number">{{ total_tasks|length }}</div>
          </div>
          {% endif %}

        </span>
      </li>
      <div id="categories-loop">
        {% for category in categories %}
        <li class="row hovered-nav-item">
          <span class="d-flex justify-content-between active-category" value="{{ category.id }}">
            <div class="category-item">
              <span class="category-link fs-5 text-white total-tasks-number d-flex" value="{{ category.id }}">
                <div class="category-name" value="{{ category.id }}">
                  {{ category.name }}
                </div>
                {% if category.task.all%}
                <div class="total-number">
                  <div class="number">{{ category.task.all|length }}</div>
                </div>
                {% endif %}
              </span>
            </div>
            <div class="dropdown d-flex">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" class="bi bi-three-dots-vertical dot-icon"
                type="button" id="dropdownMenuButton{{ category.id }}" data-bs-toggle="dropdown" aria-expanded="false"
                viewBox="0 0 16 16">
                <path
                  d="M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z" />
              </svg>

              <ul class="dropdown-menu dropdown-menu-sidebar dropdown-menu-dark"
                aria-labelledby="dropdownMenuButton{{ category.id }}">
                <li class="d-flex">
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                    class="bi bi-pen-fill bs-icon rename-add-icon rename-add-icon-sidebar" data-sender="category"
                    data-sender="sidebar" data-action="rename" data-placeholder="" data-value="{{ category.name }}"
                    data-id="{{ category.id }}" viewBox="0 0 16 16">
                    <path
                      d="m13.498.795.149-.149a1.207 1.207 0 1 1 1.707 1.708l-.149.148a1.5 1.5 0 0 1-.059 2.059L4.854 14.854a.5.5 0 0 1-.233.131l-4 1a.5.5 0 0 1-.606-.606l1-4a.5.5 0 0 1 .131-.232l9.642-9.642a.5.5 0 0 0-.642.056L6.854 4.854a.5.5 0 1 1-.708-.708L9.44.854A1.5 1.5 0 0 1 11.5.796a1.5 1.5 0 0 1 1.998-.001z" />
                  </svg>
                </li>
                <li class="d-flex mt-1">
                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="orange"
                    class="bi bi-x-lg delete-icon" data-sender="category" data-action="delete"
                    data-name="{{ category.name }}" data-source="sidebar" data-id="{{ category.id }}"
                    viewBox="0 0 16 16">
                    <path
                      d="M1.293 1.293a1 1 0 0 1 1.414 0L8 6.586l5.293-5.293a1 1 0 1 1 1.414 1.414L9.414 8l5.293 5.293a1 1 0 0 1-1.414 1.414L8 9.414l-5.293 5.293a1 1 0 0 1-1.414-1.414L6.586 8 1.293 2.707a1 1 0 0 1 0-1.414z" />
                  </svg>
                </li>
              </ul>
            </div>
          </span>
        </li>
        {% endfor %}
      </div>
    </div>
  </div>
</ul>

<script>
  var SET_ACTIVE_BOARD_URL = '{% url "dashboard:set_active_board" %}';
  var SET_ACTIVE_CATEGORY_URL = '{% url "dashboard:set_active_category" %}';
  var NEW_TASK = '{% url "task:new_task" %}';
  var CSRF_TOKEN = '{{ csrf_token }}';
  var HIGHLIGHTED_BOARD = '{{ highlighted_board }}';
  var HIGHLIGHTED_CATEGORY = '{{ highlighted_category }}';
  var IS_GUEST = '{{ is_guest }}';
  var TOTAL_CATEGORIES = '{{ categories|length }}';
  var TOTAL_TASKS= '{{ total_tasks|length }}';
</script>
<script src="{% static 'dashboard/sidebar/js/sidebar.js' %}" data-rel-js></script>